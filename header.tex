\makeatletter
\usepackage{alltt}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{babel}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{mathdots}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{multirow}
\usepackage{pdflscape}
\usepackage{pgfplots}
\usepackage{siunitx}
\usepackage{slashed}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{tkz-euclide}
\usepackage[normalem]{ulem}
\usepackage[all]{xy}
\usepackage{imakeidx}

\ifx \nauthor\undefined
    \def\nauthor{Nolan Chai}
\else
\fi

\author{Notes taken by \nauthor}
\date{\nterm\ \nyear}

\makeindex[intoc, title=Index]
\indexsetup{othercode={\lhead{\emph{Index}}}}

\newcommand\clean[1]{{\usefont{T1}{clean}{m}{n} #1 }}

\ifx \nextra \undefined
    \usepackage[
        pdftex,
        hidelinks,
        pdfauthor={Nolan Chai},
        pdfsubject = {UCSD Notes: \department\ \coursenum\ - \ncourse},
        pdftitle={\department\ \coursenum\ - \ncourse},
        pdfkeywords = {UCSD UC San Diego \department\ \coursenum\ \nterm\ \nyear\ \ncourse}
    ] {hyperref}
    \title{\department\ \coursenum\ --- \ncourse}
\else
    \usepackage[
        pdftex,
        hidelinks,
        pdfauthor = {Nolan Chai},
        pdfsubject = {UCSD Notes: \department\ \coursenum\ - \ncourse},
        pdftitle = {\department\ \coursenum\ (\nextra)},
        pdfkeywords = {UCSD UC San Diego \department\ \coursenum\ \nterm\ \nyear\ \ncourse\ \nextra}
    ] {hyperref}
    \title{\department\ \coursenum\ --- \ncourse \\ {\Large \nextra}}
    \renewcommand\printindex{}
\fi
\pgfplotsset{compat=1.12}

\pagestyle{fancyplain}
\ifx \ncoursehead \undefined
\def\ncoursehead{\ncourse}
\fi

\lhead{\emph{\nouppercase{\leftmark}}}
\ifx \nextra \undefined
  \rhead{
    \ifnum\thepage=1
    \else
      \ncoursehead
    \fi}
\else
  \rhead{
    \ifnum\thepage=1
    \else
      \ncoursehead \ (\nextra)
    \fi}
\fi
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{positioning}
\usetikzlibrary{fadings}
\usetikzlibrary{intersections}
\usetikzlibrary{cd}

\makeatother